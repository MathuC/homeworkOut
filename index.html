<html>
<head> 
	<title>HOMEwork out</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"> <!--Link to boostrap to make a professional submit page -->	
	<link rel="stylesheet" type="text/css" href="style.css"> 
	<link rel="stylesheet" type="text/css" href="animate.css"> <!--Link to animate.css to make a page with dynamic elements when loading -->
	<link rel="shortcut icon" href="img/favicon.png">
</head>
<body>
<a style="font-size:20px;font-family:Courier;margin-right:5px;margin-top:-6px;position:absolute;color:black;left:6;" href="https://mathusan.net">mathusan.net</a>
<a style="font-size:20px;font-family:Courier;margin-right:5px;margin-top:-7px;position:absolute;color:black;right:0;" href="about.html">About HomeworkOut</a>
<br>
<center>
	<img src="img/title2.png" width="500" height="60" class="animate__animated animate__flipInX">
</center>
<br>
<h5 align="center">Workout. Study. Break. Repeat.</h5>
<center>
<div id="replace">
<br>
	<div class="container">
		<div class="login-box">
				<div class="col-md-4"> <!--As you can see there are twoo classes. The class that is at the right overrides the bootstrap class if they overlap. Bootstrap class. There are 12 columns so col-md-6 means there will be 2 columns -->
					<h1>TIMER</h1>
					<form action="javascript:userStart()" method="get" autocomplete= off> <!-- This explains very well HTML forms and the type attribute https://www.w3schools.com/tags/att_input_type.asp -->
						<div class="form-group">
							<label>Time (hrs)</label>
							<select class="form-control" id="duration" name="duration">
								<option>0:30</option>
								<option selected="selected">1:00</option>
								<option>1:30</option>
								<option>2:00</option>
								<option>2:30</option>
								<option>3:00</option>
								<option>3:30</option>
								<option>4:00</option>
								<option>4:30</option>
								<option>5:00</option>
								<option>5:30</option>
								<option>6:00</option>
								<option>6:30</option>
								<option>7:00</option>
								<option>7:30</option>
								<option>8:00</option>
								<option>8:30</option>
								<option>9:00</option>
							</select>
							<br>
							<label>Fitness</label>
							<select class="form-control" id="fitness" name="fitness">
								<option>Beginner</option>
								<option selected="selected">Advanced</option>
							</select>
						</div>
						<button type="submit" class="btn btn-primary"> Start </button>
					</form>
				</div>
		</div>
	</div>
</div>
</center>
<br><br><br>
<p id="footnote" align="center">Created By Mathusan Chandramohan & Louca Dufault for McGill Code.Jam 2020</p>
</body>
<script>
var fitness; //fitness level
var duration=0; //duration of timer
var stopBtn=0; //stop button not clicked
var globalEnd=0; //when the global timer reaches the end
var alarm = new Audio('Audio/alarm.wav');
var clap = new Audio('Audio/clap.mp3');
var clock = new Audio('Audio/clock.wav');
var whistle = new Audio('Audio/whistle.wav');
var current; //workout, study, break
var t=0;

function stop(){
	if (document.getElementById("stop").innerHTML=="Pause") {
		document.getElementById("stop").innerHTML="Resume";
		stopBtn=1; //clicked
	} else {
		document.getElementById("stop").innerHTML="Pause";
		stopBtn=0;
		rawT= document.getElementById("text").innerHTML;
		listT=rawT.split(":");
		tValue=parseInt(listT[0])*60;
		tValue=tValue+parseInt(listT[1]);
		timer(tValue);
	}
}


function userStart() { //when user presses start
	rawDuration= document.getElementById("duration").value;
	listDur=rawDuration.split(":");
	duration=duration+parseInt(listDur[0])*2;
	if (listDur[1]=="30") {
		duration=duration+1;
	}
	fitness= document.getElementById("fitness").value;
	if (fitness=="Beginner") {
		work=20;
		rest=20;
	} else {
		work=5;
		rest=5;
	}
	document.getElementById("replace").innerHTML=timerHTML;
	globalTimer();
	document.getElementById("stop").addEventListener("click", stop()); //without this line the onclick event is activated when you click on the button so you have to click it 2 times first for it to work.
	workout();
}

function globalTimer(){
	var tg=duration*30*60;
	function globalDecrement(){
		second=tg%60;
		minute=((tg-second)/60)%60;
		hour=((tg-second)/60-minute)/60;
		if (tg>3599){
			display=""+hour+":";
		} else {
			display="0:";
		}
		if (tg-hour*60*60>599){
			if (second==0) {
				display=display+""+minute+":"+"00";
			} else if (second<10) {
				display=display+""+minute+":"+"0"+second;
			} else {
				display=display+""+minute+":"+second;
			}
		} else if (tg-hour*60*60>59) {
			if (second==0) {
				display=display+"0"+minute+":"+"00";
			} else if (second<10) {
				display=display+"0"+minute+":"+"0"+second;
			} else {
				display=display+"0"+minute+":"+second;
			}
		} else {
			if (second==0) {
				display=display+"00"+":"+"00";
			} else if (second<10) {
				display=display+"00"+":"+"0"+second;
			} else {
				display=display+"00"+":"+second;
			}
		} 
		tg=tg-1;
		document.getElementById("global").innerHTML="Total time remaining: "+display;
		if (tg>-1) {
			setTimeout(globalDecrement,1000);
		}
		if(tg==-1){
			globalEnd=1;
		}
	}
	globalDecrement();
}

function timer(t){ //t is in seconds
	/*
	if (t === undefined) {
		rawT= document.getElementById("text").innerHTML;
		listT=rawT.split(":");
		t=parseInt(listT[0])*60;
		t=t+parseInt(listT[1]);
	}
	*/
	function decrement(){
		if (stopBtn==1) {
			return; //if Stop button has been clicked
		}
		minute=(t-t%60)/60;
		second=t%60;
		if (t>599){
			if (second==0) {
				display=""+minute+":"+"00";
			} else if (second<10) {
				display=""+minute+":"+"0"+second;
			} else {
				display=""+minute+":"+second;
			}
		} else if (t>59) {
			if (second==0) {
				display="0"+minute+":"+"00";
			} else if (second<10) {
				display="0"+minute+":"+"0"+second;
			} else {
				display="0"+minute+":"+second;
			}
		} else {
			if (second==0) {
				display="00"+":"+"00";
			} else if (second<10) {
				display="00"+":"+"0"+second;
			} else {
				display="00"+":"+second;
			}
		} 
		t=t-1;
		if (t>-1) {
			//add time to study or workout depending on current
		}
		document.getElementById("text").innerHTML=display;
		if (globalEnd==1) {
			clap.play(); 
			document.getElementById("text").innerHTML="Done.";
			document.getElementById("stop").style.visibility = "hidden";
			t=-1;
		}
		if (t>-1 && stopBtn==0) {
			setTimeout(decrement,1000);
		}
		if(t==2){ //signals approaching alarm
			clock.play();
		}
		if(t<0){
			alarm.play();
			if (current=="workout"){
				study();
			} else if (current=="study") {
				breakTime();
			} else if (current=="breakTime") {
				workout();
			}
		}
	}
	decrement();
}



function workout(){
	document.getElementById("title").innerHTML="Workout";
	current="workout";
	timer(180);
	document.getElementById("stop").style.visibility = "hidden"; //you can't stop in the middle of working out
	document.getElementById("instruction").innerHTML= "Get Ready<br>Workout starts in 10 seconds";
	setTimeout(function(){document.getElementById("instruction").innerHTML="PUSH-UPS"+"<br>30 seconds";whistle.play();},10*1000);
	setTimeout(function(){document.getElementById("instruction").innerHTML="REST"+"<br>10 seconds";whistle.play();},40*1000);
	setTimeout(function(){document.getElementById("instruction").innerHTML="JUMPING JACKS"+"<br>30 seconds";whistle.play();},50*1000);
	setTimeout(function(){document.getElementById("instruction").innerHTML="REST"+"<br>10 seconds";whistle.play();},80*1000);
	setTimeout(function(){document.getElementById("instruction").innerHTML="SQUATS"+"<br>30 seconds";whistle.play();},90*1000);
	setTimeout(function(){document.getElementById("instruction").innerHTML="REST"+"<br>10 seconds";whistle.play();},120*1000);
	setTimeout(function(){document.getElementById("instruction").innerHTML="SIT-UPS"+"<br>30 seconds";whistle.play();},130*1000);
	setTimeout(function(){document.getElementById("instruction").innerHTML="Hydrate yourself &#128166; <br>Get ready to start studying";whistle.play();},160*1000);
}

function study(){
	current="study"; 
	document.getElementById("title").innerHTML="STUDY";
	timer(1320);
	document.getElementById("stop").style.visibility = "visible";
	document.getElementById("instruction").innerHTML="22 minutes of complete focus &#129327;";
	
}

function breakTime(){
	current="breakTime"; 
	document.getElementById("title").innerHTML="BREAK";
	timer(300);
	document.getElementById("stop").style.visibility = "visible";
	document.getElementById("instruction").innerHTML="5 minutes to relax &#128524;";
}


timerHTML=`
<b><p style="font-size:15px;" id="global"></p></b>
<div id="container">
  <img id="image" src="img/timerWhite3.png">
  <p id="title">WORKOUT</p>
  <p id="text"></p> 
</div>
<button onclick="javascript:stop()" class="btn btn-secondary" id="stop"> Pause </button>
<p id="instruction" style="font-family:Trebuchet MS;font-weight:normal;font-size:50px;line-height:50px;"></p>
`;



</script>
</html>